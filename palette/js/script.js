"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("service-worker.js").catch(e=>{alert("There has been a problem with Service Worker registration. This application may require internet connection to function properly.")})});const helpBtn=document.querySelector(".help__btn"),helpContainer=document.querySelector(".help__container"),paletteBtn=document.querySelector(".palette__btn"),paletteContainer=document.querySelector(".palette__container"),sliders=document.querySelectorAll(".palette__slider"),favoriteColorContainers=document.querySelectorAll(".palette__favorite-color");let touchStartX,touchStartY,touchEndX,touchEndY,chosenFavoriteColor,btnHold,isLongPress;hslNotationToValues=e=>{return hslArr=e.split(","),{hue:+hslArr[0].replace("hsl(",""),saturation:+hslArr[1].replace("%",""),lightness:+hslArr[2].replace("%)","")}},hslValuesToNotation=(e,t,o)=>`hsl(${e},${t}%,${o}%)`,getCustomProperty=e=>window.getComputedStyle(document.documentElement).getPropertyValue(e),setCustomProperty=(e,t)=>{document.documentElement.style.setProperty(e,t)},adjustColors=(e,t,o)=>{setCustomProperty("--screen-light",hslValuesToNotation(e,t,o)),localStorage.setItem("--screen-light",hslValuesToNotation(e,t,o)),setCustomProperty("--hue-value",hslValuesToNotation(e,100,60)),setCustomProperty("--lightness-value",hslValuesToNotation(0,0,o)),setCustomProperty("--saturation-value",hslValuesToNotation(e,t,60)),o<=30?setCustomProperty("--secondary-color",hslValuesToNotation(0,0,73)):setCustomProperty("--secondary-color",hslValuesToNotation(44,10,13)),synchronizeSliders(e,t,o)},synchronizeSliders=(e,t,o)=>{sliders[0].value=e,sliders[1].value=t,sliders[2].value=o},changeHue=e=>{let{hue:t,saturation:o,lightness:n}=hslNotationToValues(getCustomProperty("--screen-light"));t+e>360?t=t+e-360:t+e<0?t=t+e+360:t+=e,adjustColors(t,o,n)},changeLightness=e=>{let{hue:t,saturation:o,lightness:n}=hslNotationToValues(getCustomProperty("--screen-light"));n+e>100||n+e<0||(n+=e,adjustColors(t,o,n))},adjustColorsBySlider=()=>{const[e,t,o]=[sliders[0].value,sliders[1].value,sliders[2].value];adjustColors(e,t,o),chosenFavoriteColor&&(setCustomProperty(chosenFavoriteColor,hslValuesToNotation(e,t,o)),localStorage.setItem(chosenFavoriteColor,hslValuesToNotation(e,t,o)))},selectFavoriteColor=e=>{const t=e.dataset.propertyName,{hue:o,saturation:n,lightness:s}=hslNotationToValues(getCustomProperty(t));adjustColors(o,n,s),chosenFavoriteColor=t},toggleHelp=()=>{paletteContainer.classList.remove("palette__container--show"),helpContainer.classList.toggle("help__container--show"),chosenFavoriteColor=null},togglePalette=()=>{helpContainer.classList.remove("help__container--show"),paletteContainer.classList.toggle("palette__container--show"),chosenFavoriteColor=null},changeBtnsVisibility=()=>{document.querySelector(".help__icon").classList.toggle("help__icon--hide"),document.querySelector(".palette__icon").classList.toggle("palette__icon--hide"),document.querySelector(".help__icon").classList.contains("help__icon--hide")?localStorage.setItem("hide-btns",!0):localStorage.removeItem("hide-btns"),isLongPress=!0},btnReleased=e=>{clearTimeout(btnHold),isLongPress||(e===helpBtn?toggleHelp():togglePalette())},touchEnded=()=>{clearTimeout(btnHold)},document.addEventListener("keydown",function(e){switch(e.code){case"ArrowRight":changeHue(30);break;case"ArrowLeft":changeHue(-30);break;case"ArrowUp":changeLightness(10);break;case"ArrowDown":changeLightness(-10)}}),swipe=()=>{if(paletteContainer.classList.contains("palette__container--show"))return;let e=touchEndX-touchStartX,t=touchEndY-touchStartY;Math.abs(e)<80&&Math.abs(t)<80||(Math.abs(e)>Math.abs(t)?e>0?changeHue(30):changeHue(-30):t>0?changeLightness(10):changeLightness(-10))},document.addEventListener("touchstart",function(e){touchStartX=e.changedTouches[0].screenX,touchStartY=e.changedTouches[0].screenY}),document.addEventListener("touchend",function(e){touchEndX=e.changedTouches[0].screenX,touchEndY=e.changedTouches[0].screenY,swipe()}),document.querySelector(".palette__container").addEventListener("touchstart",function(e){e.stopPropagation()}),document.querySelector(".palette__container").addEventListener("touchend",function(e){e.stopPropagation()}),helpBtn.addEventListener("touchstart",function(e){isLongPress=!1,btnHold=setTimeout(changeBtnsVisibility,1300)}),helpBtn.addEventListener("touchend",function(e){touchEnded()}),helpBtn.addEventListener("mousedown",function(e){isLongPress=!1,btnHold=setTimeout(changeBtnsVisibility,1300)}),helpBtn.addEventListener("mouseup",function(e){btnReleased(e.currentTarget)}),paletteBtn.addEventListener("touchstart",function(e){isLongPress=!1,btnHold=setTimeout(changeBtnsVisibility,1300)}),paletteBtn.addEventListener("touchend",function(e){touchEnded()}),paletteBtn.addEventListener("mousedown",function(e){isLongPress=!1,btnHold=setTimeout(changeBtnsVisibility,1300)}),paletteBtn.addEventListener("mouseup",function(e){btnReleased(e.currentTarget)}),document.addEventListener("mouseup",function(e){clearTimeout(btnHold)});for(let e of sliders)e.addEventListener("input",function(e){adjustColorsBySlider()});for(let e of favoriteColorContainers)e.addEventListener("click",function(e){selectFavoriteColor(e.target)});!function(){if(localStorage.getItem("--screen-light")){let{hue:e,saturation:t,lightness:o}=hslNotationToValues(localStorage.getItem("--screen-light"));adjustColors(e,t,o)}localStorage.getItem("hide-btns")&&(document.querySelector(".help__icon").classList.add("help__icon--hide"),document.querySelector(".palette__icon").classList.add("palette__icon--hide"));for(let e of favoriteColorContainers)localStorage.getItem(e.dataset.propertyName)&&setCustomProperty(e.dataset.propertyName,localStorage.getItem(e.dataset.propertyName))}();